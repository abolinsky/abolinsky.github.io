<!DOCTYPE html>
<html lang="en">
{{ partial "head.html" . }}
<body>
  {{ partial "nav.html" . }}
  <main>
    {{ block "main" . }}{{ end }}
  </main>
  <script>
    function toggleTheme() {
      const html = document.documentElement;
      const btn = document.querySelector('.theme-toggle');
      if (html.getAttribute('data-theme') === 'light') {
        html.removeAttribute('data-theme');
        localStorage.setItem('theme', 'dark');
      } else {
        html.setAttribute('data-theme', 'light');
        localStorage.setItem('theme', 'light');
      }
    }
    // Load saved theme
    (function() {
      const saved = localStorage.getItem('theme');
      if (saved === 'light') {
        document.documentElement.setAttribute('data-theme', 'light');
      }
    })();
    // Cycle link colors in content
    (function() {
      const colors = ['var(--link-1)', 'var(--link-2)', 'var(--link-3)', 'var(--link-4)'];
      // Home page and article content links
      const contentLinks = document.querySelectorAll('main > :not(.post-list):not(.post-nav):not(.book-list) a:not(.post-nav a)');
      let i = 0;
      contentLinks.forEach((link) => {
        if (!link.closest('.post-list') && !link.closest('.post-nav') && !link.closest('.book-list') && !link.closest('footer')) {
          link.style.color = colors[i % 4];
          i++;
        }
      });
      // Bookshelf links
      const bookLinks = document.querySelectorAll('.book-list .book-entry a');
      bookLinks.forEach((link, j) => {
        link.style.color = colors[j % 4];
      });
    })();
  </script>
</body>
</html>
